<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Valentine ğŸ’–</title>

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap" rel="stylesheet">

<style>
  body {
    background: linear-gradient(135deg, #ffe0e9 0%, #ffd1dc 100%);
    font-family: 'Playfair Display', serif;
    overflow: hidden;
  }

  /* BOOK / CARD GLASS EFFECT */
  .book {
    background: rgba(255, 255, 255, 0.4);
    backdrop-filter: blur(12px);
    border-radius: 24px;
    box-shadow: 0 20px 40px rgba(255, 192, 203, 0.4);
    padding: 50px 40px;
    max-width: 520px;
    text-align: center;
    position: relative;
    z-index: 2;
    animation: pageFlip 1.8s ease forwards;
    transform-origin: left;
    perspective: 1200px;
  }

  /* Page flip animation */
  @keyframes pageFlip {
    0% { transform: rotateY(90deg); opacity: 0; }
    60% { transform: rotateY(-20deg); opacity: 1; }
    100% { transform: rotateY(0deg); opacity: 1; }
  }

  /* Floating hearts/flowers */
  @keyframes float {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-15px); }
  }

  .float {
    animation: float 6s ease-in-out infinite;
    opacity: 0.8;
    position: absolute;
    z-index: 1;
  }

  /* NO button */
  #noBtn {
    position: absolute;
    transition: top 0.25s ease, left 0.25s ease, transform 0.25s ease;
    z-index: 10;
  }

  /* YES button hover scale */
  #yesBtn {
    transition: transform 0.3s ease;
  }

  /* Popup overlay */
  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(255,182,193,0.5);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 50;
  }

  .overlay .popup-card {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(10px);
    border-radius: 24px;
    padding: 30px;
    max-width: 400px;
    box-shadow: 0 10px 30px rgba(255,192,203,0.5);
  }
  /* PRELOADER STYLES */
#preloader {
  position: fixed;
  inset: 0;
  background: #ffe0e9;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: opacity 0.8s ease, visibility 0.8s ease;
}

#preloader iframe {
  width: 100%;
  height: 100%;
  border: none;
}

#preloader.hide {
  opacity: 0;
  visibility: hidden;
}

</style>
</head>

<body>
<!-- PRELOADER -->
<div id="preloader">
  <iframe 
    src="{{ url_for('flower') }}" 
    frameborder="0"
    scrolling="no">
  </iframe>
</div>

<audio id="bgMusic" preload="auto" loop>
  <source src="{{ url_for('static', filename='music/dil-ninja_iD1oeThl.mp3') }}" type="audio/mpeg">
</audio>


<!-- Floating Images -->
<img src="{{ url_for('static', filename='images/rose.png') }}" class="float" style="top:10px; left:20px; width:50px;">
<img src="{{ url_for('static', filename='images/heart.png') }}" class="float" style="top:50px; right:40px; width:45px;">
<img src="{{ url_for('static', filename='images/book.png') }}" class="float" style="bottom:20px; left:30px; width:60px;">
<img src="{{ url_for('static', filename='images/flower.png') }}" class="float" style="bottom:50px; right:20px; width:50px;">
<img src="{{ url_for('static', filename='images/heart2.png') }}" class="float" style="top:200px; left:150px; width:35px;">
<img src="{{ url_for('static', filename='images/rose2.png') }}" class="float" style="bottom:150px; right:120px; width:40px;">

<!-- STAGE -->
<div id="stage" class="vw-100 vh-100 d-flex align-items-center justify-content-center position-relative">

  <div class="book">
    <!-- MUSIC CONTROL -->
     
<div class="mb-3">
  <button id="musicBtn" class="btn btn-outline-danger btn-sm">
    â–¶ Play Music ğŸ¶
  </button>
</div>

<h1 class="text-danger mb-3">A Page From My Heart ğŸ’—</h1>

<p class="text-secondary mb-4">
  Dear sweetheart,<br>
  my heart does little happy dances whenever youâ€™re near.<br>
  Youâ€™re my bae, my rasmalai, my laddoo wrapped in love,<br>
  and honestlyâ€¦ my favorite everything.
</p>

<h4 class="text-danger mb-4">
  Will you be my Valentine, my love? ğŸ¥°ğŸ’˜
</h4>


    <!-- YES only -->
    <div class="d-flex justify-content-center">
      <a href="/memories" id="yesBtn" class="btn btn-danger btn-lg">
        Yes ğŸ’–
      </a>
    </div>
  </div>

  <!-- NO BUTTON -->
  <button id="noBtn" class="btn btn-outline-danger btn-lg">
    No ğŸ™ˆ
  </button>
</div>

<!-- Popup -->
<div id="popup" class="overlay">
  <div class="popup-card text-center">
    <h3 class="text-danger mb-3">Pleaseeeee ğŸ’—</h3>
    <p class="text-secondary mb-4">
      Please be my Valentine.<br>
      I love you and Iâ€™ll love you to my fullest,<br>
      today, tomorrow, always.
    </p>
    <button class="btn btn-danger" onclick="closePopup()">Okayâ€¦ ğŸ’</button>
  </div>
</div>

<script>
  let musicStarted = false;

function startMusic() {
  if (!musicStarted) {
    music.play().then(() => {
      musicStarted = true;
    }).catch(() => {});
  }
}

document.addEventListener("click", startMusic);
document.addEventListener("touchstart", startMusic);

const stage = document.getElementById("stage");
const noBtn = document.getElementById("noBtn");
const yesBtn = document.getElementById("yesBtn");
const popup = document.getElementById("popup");
const music = document.getElementById("bgMusic");

let yesScale = 1;
let escapes = 0;

// unlock autoplay
// window.addEventListener("click", () => music.play(), { once: true });

// initial position: next to Yes
function placeNoNextToYes() {
  const yesRect = yesBtn.getBoundingClientRect();
  const stageRect = stage.getBoundingClientRect();
  noBtn.style.left = `${yesRect.right - stageRect.left + 16}px`;
  noBtn.style.top = `${yesRect.top - stageRect.top}px`;
}
placeNoNextToYes();

// safe move
function moveNoSafely() {
  escapes++;

  if (escapes % 3 === 0) return; // allow click sometimes

  const stageRect = stage.getBoundingClientRect();
  const btnRect = noBtn.getBoundingClientRect();
  const padding = 12;

  const maxX = stageRect.width - btnRect.width - padding;
  const maxY = stageRect.height - btnRect.height - padding;

  const x = Math.random() * maxX + padding;
  const y = Math.random() * maxY + padding;

  noBtn.style.left = `${x}px`;
  noBtn.style.top = `${y}px`;

  // grow YES
  yesScale += 0.4;
  yesBtn.style.transform = `scale(${yesScale})`;
}

noBtn.addEventListener("mouseenter", moveNoSafely);
noBtn.addEventListener("click", () => popup.style.display = "flex");

function closePopup() {
  popup.style.display = "none";
}

window.addEventListener("load", () => {
  setTimeout(() => {
    document.getElementById("preloader").classList.add("hide");
    startMusic();
  }, 10000); // adjust to match flower animation
});
const musicBtn = document.getElementById("musicBtn");
let isPlaying = false;

musicBtn.addEventListener("click", () => {
  if (!isPlaying) {
    music.play();
    musicBtn.innerHTML = "â¸ Pause Music";
    isPlaying = true;
  } else {
    music.pause();
    musicBtn.innerHTML = "â–¶ Play Music ğŸ¶";
    isPlaying = false;
  }
});

</script>
</body>
</html>
